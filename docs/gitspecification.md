# Git 使用规范

`Git`使用规范主要是**开发流程**和**提交信息**的规范，下面我就以上两点分别说一说。

## 开发流程

在做开发之前理应明白你接下来应该做的事情是什么，比如添加新的功能，又比如修复发现的错误，这样你能够很好的对你接下来要写的代码进行描述，以下为标准的开发流程：

  - 首先从`master`分支上面切出你的开发分支`feature`或者`fix`又或者是什么别的名称。
  - 然后在你的分支上进行开发，并且完成自测。
  - 编写规范的`git message`内容，发起一次`commit`。
  - 等待做`code review`的人进行代码审查。
  - 切换回`master`分支，并且合并你开发分支的代码。

在几乎所有的公司都有自己的`Git`远程仓库，也基本都遵循上述的开发流程，但是在`GitHub`上想对别人的仓库贡献你的代码，流程略有不同，下面来看看`GitHub`代码提交的流程：

  - 首先`fork`你要提交代码的仓库，比如这个仓库`mintsweet/practice`。
  - 然后`clone`你账户上的这个仓库到本地。
  - 开发的时候无需单独开分支进行开发，你只需要清楚的知道你在做什么，比如给`master`分支的代码进行错误修复，又比如给`dev`分支新增功能用于下次发版本。
  - 开发完成以后，如果仓库需要你编写对应的测试用例，你还必须编写对应的测试用例，如果没有，那么就发起一次规范的`commit`。
  - 将本地仓库的提交推送到你远程`GitHub`账号中的对应仓库。
  - 这时候你到你想提交代码的仓库就会发现多了一个可以提交`pull request`的选项，然后你就可以发起一次`pr`了。
  - 等待仓库作者对你的代码进行`code review`，如果此时作者觉得你的代码不错，会直接合并到他的仓库，如果觉得不错但是有改进的地方，作者可能会要求你改进之后继续提交，然后重复步骤最后合并代码，如果作者觉得你的代码不行，可能你这次`pr`就会被关闭，表示你的这次提交没有意义。

这两个开发流程基本就算是你在**公司开发业务时候的规范**和**你想为开源社区做贡献的时候的规范**了，请一定要严格遵守其中每一步的要求。

## Message 规范

在每一次`git commit`的时候我们都需要在其中加入`message`的信息，这个信息能够有效的帮助我们了解到每一次`git commit`的意义所在，并且帮助`code review`的人快速的理解你的这一次`git commit`的作用，更快的理解代码的涵义，所以每一次规范的`message`都是有必要的。

`git`提供了`commit-msg`钩子，让我们可以很容易的获取到`message`，来判断提交的信息是否符合团队的规范。

像我这个项目`mintsweet/practice`使用已经比较成熟的解决方案[commitlint](https://github.com/marionebl/commitlint)，并且结合[husky](https://github.com/typicode/husky)来校验每一次`commit message`是否符合规范。

### 规范定义

#### 基本格式

```bash
type(scope?): <subject>

<body>?

<foot>?
```

`type`只能小写并且不能唯恐，`scope`只能小写，`subject`简短清晰的描述这次提交并且不能为空。

`body`可以是你这次提交的详细描述，比如新增的方法的作用，`foot`可以是你这次提交的代码会带来什么影响，比如测试影响。

#### 类型(type)定义

  - `build`: 版本发布
  - `ci`: 集成环境的变动
  - `chore`: 构建过程或者辅助工具的变动
  - `docs`: 文档
  - `feat`: 新功能
  - `fix`: 修复Bug
  - `perf`: 优化相关
  - `refactor`: 重构(即不是新增功能，也不是修改 Bug 的代码变动)
  - `revert`: commit 回滚
  - `style`: 代码格式(即不影响代码运行的变动)
  - `test`: 测试相关

### 示例

#### Build

```bash
build(server): 发布版本v1.0.0

版本描述(可选)：
<版本发布新增的功能描述，修复的之前版本的Bug描述>

测试影响(可选)：
<描述对现有功能的影响，测试需要注意的地方>
```

#### Ci

```bash
ci(root): 新增集成测试
```

#### Chore

```bash
chore(server): 完善 XXX 逻辑

完善理由(可选):
<简单介绍>

测试影响(可选):
<描述对现有功能的影响，测试需要注意的地方>
```

#### Docs

```bash
docs(root): 新增 XXX 文档
```

#### Feat

```bash
feat(client): 功能简单描述

实现方法(可选):
<具体实现方法的描述>

测试影响(可选):
<描述对现有功能的影响，测试需要注意的地方>
```

#### Fix

```bash
fix(server): 简单描述错误信息

产生原因(可选):
<描述Bug的产生原因>

解决方法(可选):
<描述如何修复bug>

测试影响(可选):
<描述对现有功能的影响，测试需要注意的地方>
```

#### Perf

```bash
perf(server): 优化理由简单描述

优化理由(可选):
<描述优化的原因>

测试影响(可选):
<描述改动后会不会带来功能测试的影响>
```

#### Refactor

```bash
refactor(server): 重构理由的简单描述
```

#### Revert

```bash
revert(server): commit回滚的理由简单描述

回滚理由(可选):
<描述回滚的commit带来的错误>

测试影响(可选):
<描述回滚之后带来的功能测试影响>
```

#### Style

```bash
style(native): 风格改变的理由
```

#### Test

```bash
test(server): 新增了 XXX 接口的单元测试
```
